<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Secure Booking Code Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --color-bg: #0e1320;
            --color-panel: #21294a;
            --color-accent: #00d98a;
            --color-accent2: #3060ec;
            --color-accent3: #e82445;
            --color-text: #f3f3f3;
            --color-danger: #ff4c4c;
            --color-disabled: #55576b;
            --color-copy: #ffd200;
            --border-radius: 16px;
            --logo-shadow: 0 4px 16px rgba(0,0,0,0.18);
        }
        body {
            background: linear-gradient(135deg, var(--color-panel) 20%, var(--color-bg) 90%);
            color: var(--color-text);
            font-family: 'Segoe UI', Roboto, Arial, sans-serif;
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            background: var(--color-panel);
            border-radius: var(--border-radius);
            box-shadow: 0 6px 32px rgba(0,0,0,0.45);
            padding: 38px 30px 30px 30px;
            width: 100%;
            max-width: 380px;
            text-align: center;
            position: relative;
        }
        /* Make logos true circles, remove white background & padding, ensure image covers the circle */
        .logo-img, .profile-logo, .booking-logo, .main-logo-img {
            width: 110px;
            height: 110px;
            margin: 0 auto 16px auto;
            display: block;
            border-radius: 50%;
            box-shadow: var(--logo-shadow);
            background: transparent; /* remove white background */
            padding: 0; /* remove white padding */
            object-fit: cover; /* scale image to fill circle */
            overflow: hidden; /* crop any overflow so no white margin shows */
        }
        .main-logo-img {
            /* previously forced square â€” now circular */
            margin-bottom: 16px;
        }
        .rotating {
            animation: rotate 2s linear infinite;
        }
        @keyframes rotate {
            0% {transform: rotate(0deg);}
            100% {transform: rotate(360deg);}
        }
        .hidden {
            display: none !important;
        }
        .pin-input {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            background: var(--color-bg);
            color: var(--color-accent);
            border: 2px solid var(--color-accent);
            border-radius: 12px;
            padding: 10px 0;
            width: 100%;
            margin-bottom: 16px;
            letter-spacing: 12px;
            outline: none;
        }
        .btn {
            background: var(--color-accent2);
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 1.15rem;
            font-weight: 500;
            padding: 10px 20px;
            cursor: pointer;
            margin-top: 12px;
            margin-bottom: 4px;
            box-shadow: 0 2px 8px rgba(48,96,236,0.09);
            transition: background 0.2s;
        }
        .btn:disabled {
            background: var(--color-disabled);
            cursor: not-allowed;
        }
        .profile-section {
            margin-top: 20px;
            background: var(--color-bg);
            border-radius: var(--border-radius);
            padding: 18px 12px;
        }
        .profile-item {
            margin: 12px 0;
            font-size: 1.13rem;
        }
        .expire-warning {
            color: var(--color-danger);
            font-weight: bold;
            margin-top: 12px;
        }
        .notify {
            background: var(--color-danger);
            color: #fff;
            border-radius: 6px;
            padding: 10px 12px 14px 12px;
            font-size: 1.07rem;
            margin-top: 18px;
        }
        .sub-btn {
            background: var(--color-copy);
            color: var(--color-panel);
            border: none;
            border-radius: 8px;
            font-size: 1.03rem;
            font-weight: 600;
            padding: 7px 16px;
            cursor: pointer;
            margin: 10px 0 0 0;
            transition: background 0.2s;
            display: inline-block;
        }
        .sub-btn:hover {
            background: #fff;
            color: var(--color-copy);
        }
        .user-provider-label {
            display: inline-block;
            background: var(--color-accent);
            color: var(--color-panel);
            border-radius: 6px;
            font-size: 0.98rem;
            font-weight: 600;
            padding: 2px 10px;
            margin-left: 8px;
            vertical-align: middle;
            letter-spacing: 0.01em;
        }
        .typing-dots {
            display: inline-block;
            letter-spacing: 2px;
            font-size: 1.22rem;
            vertical-align: middle;
            font-weight: bold;
            color: var(--color-accent);
        }
        .booking-logo {
            margin-bottom: 18px;
        }
        .booking-code {
            font-size: 1.7rem;
            font-weight: bold;
            background: #181c28;
            color: var(--color-copy);
            border-radius: 10px;
            padding: 16px 10px;
            margin: 0 0 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            user-select: none;
        }
        .copy-icon {
            cursor: pointer;
            color: var(--color-copy);
            font-size: 1.25rem;
            transition: color 0.2s;
            user-select: none;
        }
        .copy-icon:hover {
            color: #fff;
        }
        .footer-note {
            margin-top: 32px;
            color: #888;
            font-size: 0.95rem;
        }
        /* Loading logo for provider */
        #providerLogoLoading {
            width: 110px;
            height: 110px;
            margin: 0 auto 16px auto;
            display: block;
            border-radius: 50%;
            box-shadow: var(--logo-shadow);
            background: transparent;
            padding: 0;
            object-fit: cover;
            overflow: hidden;
        }
        #providerLoadingText {
            font-size: 1.25rem;
            color: var(--color-accent2);
            margin-bottom: 18px;
            font-weight: bold;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Loading Section -->
        <!-- REPLACE 'your_image.png' with your actual image filename and place it in the assets folder -->
        <img src="AddText_07-29-05.39.03.png" id="mainLogo" class="main-logo-img rotating" alt="Loading"/>
        <div id="loadingText"><span class="typing-dots" id="dots"></span></div>

        <!-- PIN Section -->
        <form id="pinForm" class="hidden">
            <div>
                <input type="password" id="pinInput" class="pin-input" maxlength="4" pattern="\d{4}" inputmode="numeric" autocomplete="off" placeholder="Enter PIN" required>
            </div>
            <button type="submit" class="btn">Login</button>
            <div id="pinError" class="expire-warning hidden"></div>
        </form>

        <!-- Provider Logo Loading Section -->
        <div id="providerLogoLoadingSection" class="hidden">
            <img id="providerLogoLoading" class="logo-img rotating" src="" alt="Provider Logo Loading"/>
            <div id="providerLoadingText"><span class="typing-dots" id="providerDots"></span></div>
        </div>

        <!-- Profile Section -->
        <div id="profileSection" class="profile-section hidden">
            <img id="profileLogo" class="logo-img" src="" alt="Provider Logo"/>
            <div class="profile-item"><strong>User PIN:</strong> <span id="profilePin"></span></div>
            <div class="profile-item"><strong>User ID:</strong> <span id="profileUserId"></span>
                <span class="user-provider-label" id="profileProviderLabel"></span>
            </div>
            <div class="profile-item"><strong>Subscription:</strong> <span id="profileMonths"></span> month(s)</div>
            <div class="profile-item"><strong>Expiration:</strong> <span id="profilePinExpire"></span></div>
            <div id="expireWarn" class="expire-warning hidden">Your PIN has expired. Please contact support.</div>
            <div id="notify" class="notify hidden"></div>
            <div class="booking-section">
                <button id="generateCodeBtn" class="btn">Generate Booking Code</button>
            </div>
        </div>

        <!-- Booking Code Section (separate) -->
        <div id="bookingSection" class="hidden">
            <img id="bookingLogo" class="booking-logo rotating" src="" alt="Booking Logo"/>
            <div class="booking-code" id="bookingCodeRow">
                <span id="bookingCode"></span>
                <span id="copyIcon" class="copy-icon" title="Copy & Open">&#128203;</span>
            </div>
            <div id="bookingMsg" class="profile-item"></div>
            <button id="backToProfileBtn" class="btn" style="margin-top:6px;">Back to Profile</button>
        </div>

        <div class="footer-note">
            &copy; 2025 EmpireStateBank - Secure Booking System
        </div>
    </div>
<script>
    // --- Booking Codes Labels (edit only here!) ---
    const BOOKING_CODES = {
        Sportybet: { code: "No Code Today", link: "https://www.sportybet.com/ng/m/code-hub/load-code?source=home" },
        Betking:   { code: "BK-4455667", link: "https://m.betking.com/sports/book-bet?ic_source=internal&ic_medium=Menu&ic_campaign=NG-MENU-BookBet-Mob&ic_content=MENU-BookBet-mob" },
        Bet9ja:    { code: "BN-1234567", link: "https://old-mobile.bet9ja.com/Schedina.aspx" }
    };

    // --- Provider logos for browser (now LOCAL images in assets folder) ---
    const PROVIDER_LOGOS = {
        Sportybet: "AddText_10-13-10.20.57.png",
        Betking:   "AddText_10-13-10.22.08.png",
        Bet9ja:    "AddText_10-13-10.22.25.png"
    };

    // --- User Data: PIN, ID, Provider, Subscription months, Expiration ---
    const USERS = [
        {
            id: "USER0001",
            pin: "3572",
            profileProvider: "Betking",
            subscriptionMonths: 3,
            pinExpire: "2025-12-31T10:55:59",
        },
        {
            id: "USER0002",
            pin: "2016",
            profileProvider: "Sportybet",
            subscriptionMonths: 6,
            pinExpire: "2025-12-31T15:00:00",
        },
        {
            id: "USER0003",
            pin: "6699",
            profileProvider: "Sportybet",
            subscriptionMonths: 4,
            pinExpire: "2025-12-31T09:25:00",
        },
           {
            id: "USER4501",
            pin: "2255",
            profileProvider: "Sportybet",
            subscriptionMonths: 1,
            pinExpire: "2025-12-22T16:03:50",
        }
    ];

    // Helper for date display in local time, 12/24hr formats, NO GMT/UTC
    function formatDateLocal(dtString) {
        const d = new Date(dtString);
        const options24 = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute:'2-digit', second:'2-digit', hour12: false };
        const options12 = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute:'2-digit', second:'2-digit', hour12: true };
        return `${d.toLocaleString(undefined, options24)} / ${d.toLocaleString(undefined, options12)}`;
    }
    function isPinExpired(dtString) {
        return new Date() > new Date(dtString);
    }

    // Loading dots animation for main
    let dotCount = 0;
    let loadingInterval;
    function startLoadingDots() {
        const dotsElem = document.getElementById("dots");
        loadingInterval = setInterval(() => {
            dotCount = (dotCount + 1) % 4;
            dotsElem.textContent = "Loading" + ".".repeat(dotCount);
        }, 500);
    }
    function stopLoadingDots() {
        clearInterval(loadingInterval);
        document.getElementById("dots").textContent = "";
    }
    startLoadingDots();

    // Loading dots for provider logo
    let providerDotCount = 0;
    let providerLoadingInterval;
    function startProviderLoadingDots() {
        const dotsElem = document.getElementById("providerDots");
        providerDotCount = 0;
        providerLoadingInterval = setInterval(() => {
            providerDotCount = (providerDotCount + 1) % 4;
            dotsElem.textContent = "Loading" + ".".repeat(providerDotCount);
        }, 500);
    }
    function stopProviderLoadingDots() {
        clearInterval(providerLoadingInterval);
        document.getElementById("providerDots").textContent = "";
    }

    // State
    let currentUser = null;

    // Initial loading 6s
    const mainLogo = document.getElementById("mainLogo");
    const loadingText = document.getElementById("loadingText");
    const pinForm = document.getElementById("pinForm");

    // PIN input: only numbers, max 4 digits
    const pinInput = document.getElementById("pinInput");
    pinInput.addEventListener("input", function(e) {
        this.value = this.value.replace(/[^\d]/g, '').slice(0,4);
    });

    pinInput.addEventListener("focus", function(e) {
        this.setAttribute("inputmode", "numeric");
        this.setAttribute("pattern", "\\d{4}");
    });

    setTimeout(() => {
        stopLoadingDots();
        mainLogo.classList.add("hidden");
        loadingText.classList.add("hidden");
        pinForm.classList.remove("hidden");
        pinInput.focus();
    }, 6000);

    // PIN submit
    pinForm.addEventListener("submit", function(e){
        e.preventDefault();
        const pinVal = pinInput.value;
        const user = USERS.find(u => u.pin === pinVal);
        const pinError = document.getElementById("pinError");
        if (!user) {
            pinError.textContent = "Incorrect PIN. Try again.";
            pinError.classList.remove("hidden");
            pinInput.value = "";
            pinInput.focus();
            return;
        } else {
            pinError.classList.add("hidden");
            currentUser = user;
            pinForm.classList.add("hidden");
            showProviderLogoLoading(currentUser.profileProvider);
        }
    });

    function showProviderLogoLoading(provider) {
        // Show logo loading section
        document.getElementById("providerLogoLoading").src = PROVIDER_LOGOS[provider];
        document.getElementById("providerLogoLoadingSection").classList.remove("hidden");
        startProviderLoadingDots();
        setTimeout(() => {
            stopProviderLoadingDots();
            document.getElementById("providerLogoLoadingSection").classList.add("hidden");
            showProfileSection();
        }, 6000);
    }

    function showProfileSection() {
        document.getElementById("profileSection").classList.remove("hidden");
        document.getElementById("bookingSection").classList.add("hidden");

        document.getElementById("profileLogo").src = PROVIDER_LOGOS[currentUser.profileProvider];
        document.getElementById("profilePin").textContent = currentUser.pin;
        document.getElementById("profileUserId").textContent = currentUser.id;
        document.getElementById("profileProviderLabel").textContent = currentUser.profileProvider;
        document.getElementById("profileMonths").textContent = currentUser.subscriptionMonths;
        document.getElementById("profilePinExpire").textContent = formatDateLocal(currentUser.pinExpire);

        if (isPinExpired(currentUser.pinExpire)) {
            document.getElementById("expireWarn").classList.remove("hidden");
            document.getElementById("generateCodeBtn").disabled = true;
            document.getElementById("notify").innerHTML =
                'Your PIN has expired. You cannot generate a booking code.' +
                '<br><a href="https://paystack.shop/pay/hi79etvoja" target="_blank" class="sub-btn">Subscribe</a>';
            document.getElementById("notify").classList.remove("hidden");
        } else {
            document.getElementById("expireWarn").classList.add("hidden");
            document.getElementById("generateCodeBtn").disabled = false;
            document.getElementById("notify").classList.add("hidden");
            document.getElementById("notify").innerHTML = "";
        }
    }

    // Generate booking code button
    document.getElementById("generateCodeBtn").addEventListener("click", function(){
        if (isPinExpired(currentUser.pinExpire)) {
            document.getElementById("notify").innerHTML =
                'Your PIN has expired. You cannot generate a booking code.' +
                '<br><a href="https://paystack.shop/pay/hi79etvoja" target="_blank" class="sub-btn">Subscribe</a>';
            document.getElementById("notify").classList.remove("hidden");
            return;
        }
        document.getElementById("profileSection").classList.add("hidden");
        const bookingSection = document.getElementById("bookingSection");
        bookingSection.classList.remove("hidden");
        const bookingLogo = document.getElementById("bookingLogo");
        bookingLogo.src = PROVIDER_LOGOS[currentUser.profileProvider];
        bookingLogo.classList.add('rotating');
        document.getElementById("bookingCodeRow").classList.add("hidden");
        document.getElementById("bookingMsg").textContent = "";
        let bDotCount = 0;
        let bInterval;
        function showBookingDots() {
            bInterval = setInterval(() => {
                bDotCount = (bDotCount + 1) % 4;
                document.getElementById("bookingMsg").textContent = "Generating code" + ".".repeat(bDotCount);
            }, 500);
        }
        showBookingDots();
        setTimeout(()=>{
            clearInterval(bInterval);
            const provider = currentUser.profileProvider;
            const codeObj = BOOKING_CODES[provider];
            document.getElementById("bookingCode").textContent = codeObj.code;
            document.getElementById("bookingMsg").textContent = "Tap the copy icon to copy & open your code link.";
            document.getElementById("bookingCodeRow").classList.remove("hidden");
        }, 6000);
    });

    // Only copy on icon click (not long press/touch)
    document.getElementById("copyIcon").addEventListener("click", function(e){
        const provider = currentUser.profileProvider;
        const codeObj = BOOKING_CODES[provider];
        // Only allow copy when clicking the icon
        if (navigator.clipboard) {
            navigator.clipboard.writeText(codeObj.code).then(() => {
                document.getElementById("bookingMsg").textContent = "Code copied! Opening link...";
            });
        } else {
            const textarea = document.createElement('textarea');
            textarea.value = codeObj.code;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            document.getElementById("bookingMsg").textContent = "Code copied! Opening link...";
        }
        window.open(codeObj.link, "_blank");
        e.preventDefault(); // Prevent long press copy
    });

    // Prevent long press/touch copy on bookingCode
    document.getElementById("bookingCode").addEventListener("copy", function(e){
        e.preventDefault();
    });
    document.getElementById("bookingCode").addEventListener("mousedown", function(e){
        if(e.button === 2){ // right click
            e.preventDefault();
        }
    });
    document.getElementById("bookingCode").addEventListener("touchstart", function(e){
        e.preventDefault();
    });

    document.getElementById("backToProfileBtn").addEventListener("click", function(){
        document.getElementById("bookingSection").classList.add("hidden");
        showProfileSection();
    });
</script>
</body>
</html>
